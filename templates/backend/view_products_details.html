{% extends 'backend/base.html' %}
{% load static %}
{% block title %}View Products{% endblock %}

{% block content %}
<div class="content-wrapper">
  <!-- Content -->
  <div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4">
      <span class="text-muted fw-light">Product /</span> Details
    </h4>

    <div class="row">
      <div class="col-lg-12 mb-6 order-0">
        <div class="card shadow-sm">
          <h5 class="card-header"> Product Details</h5>
          <div class="card-body">
            
            {% if det %}
            <div class="row g-4 align-items-start">
              
              <!-- Product Images Carousel -->
              <div class="col-12 col-md-6">
                <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                  
                  <!-- Indicators -->
                  <div class="carousel-indicators">
                    {% if det.main_image %}
                      <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="0" class="active"></button>
                    {% endif %}
                    {% for img in det.images.all %}
                      <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="{{ forloop.counter }}"></button>
                    {% endfor %}
                  </div>

                  <!-- Carousel items -->
                  <div class="carousel-inner rounded shadow-sm border">
                    {% if det.main_image %}
                    <div class="carousel-item active">
                      <img src="{{ det.main_image.url }}" class="d-block w-100 img-fluid" alt="{{ det.name }}">
                    </div>
                    {% endif %}
                    
                    {% for img in det.images.all %}
                    <div class="carousel-item {% if not det.main_image and forloop.first %}active{% endif %}">
                      <img src="{{ img.image.url }}" class="d-block w-100 img-fluid" alt="{{ det.name }}">
                    </div>
                    {% endfor %}
                  </div>

                  <!-- Controls -->
                  <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev" >
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>

              <!-- Product Info -->
              <div class="col-12 col-md-6">
                <h4 class="fw-bold text-dark mb-3">
                  {{ det.name }}
                </h4>

                <h5 class="text-primary mb-3">
                  â‚¦{{ det.price }}
                </h5>

                <p class="text-muted mb-4">
                  {{ det.description|linebreaks }}
                </p>

                <!-- Meta Info -->
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <strong>Status:</strong>
                    {% if det.is_active %}
                      <span class="badge bg-success">Active</span>
                    {% else %}
                      <span class="badge bg-danger">Inactive</span>
                    {% endif %}
                  </li>
                  <li class="list-group-item">
                    <strong>Quantity:</strong> {{ det.quantity }}
                  </li>
                  <li class="list-group-item">
                    <strong>Created:</strong> {{ det.created_at|date:"M d, Y H:i" }}
                  </li>
                  <li class="list-group-item">
                    <strong>Last Updated:</strong> {{ det.updated_at|date:"M d, Y H:i" }}
                  </li>
                </ul>
              </div>
            </div>
            {% endif %}
            
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
/* Keep carousel images neat */
.carousel-item img {
  height: 350px;
  object-fit: contain;
  background: #f8f9fa;
}
@media (max-width: 768px) {
  .carousel-item img {
    height: 250px;
  }
}

/* Make carousel buttons black */
.carousel-control-prev-icon,
.carousel-control-next-icon {
  filter: invert(100%) brightness(0%) contrast(100%);
}
</style>
{% endblock %}
